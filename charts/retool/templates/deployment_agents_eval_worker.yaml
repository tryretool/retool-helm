{{ include "retool.worker.deployment" ( dict 
  "context" . 
  "worker" ( dict 
    "enabled" (include "retool.agents.enabled" .)

    "name" (include "retool.agentEvalWorker.name" .)
    "selectorLabels" (include "retool.agentEvalWorker.selectorLabels" .)
    "labels" (include "retool.agentEvalWorker.labels" .)

    "containerName" "agent-eval-worker"
    "serviceType" "AGENT_EVAL_TEMPORAL_WORKER"
    "taskqueue" "agent-eval"

    "annotations" (.Values.agents.annotations | default dict)
    "prometheusAnnotations" true

    "healthcheckPort" "3012"
    "metricsPort" "9090"

    "replicaCount" ((.Values.agents.evalWorker).replicaCount | default 1)
    "resources" ((.Values.agents.evalWorker).resources | default .Values.resources)

    "nodeOptions" ((.Values.agents.config).nodeOptions | default "--max_old_space_size=1024")
    "config" (.Values.agents.config | default dict)
    "dbConnectorTimeout" (.Values.agents.dbConnectorTimeout | default (.Values.config.dbConnectorTimeout | default ""))
  )
) }}
